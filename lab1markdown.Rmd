---
title: "lab1markdown"
author: "Jimmy Wong, Gabrielle Doran, and Zev Rosen"
date-format: short
output:
  pdf_document: default
  html_document: default
editor: visual
format:
  pdf:
    documentclass: scrartcl
    classoption: onecolumn
---

---
title: "Lab 1"
author: "Jimmy, Gabrielle, and Zev" 
date: "`r Sys.Date()`"
date-format: short 
format: 
  pdf: 
    documentclass: scrartcl
    classoption: onecolumn
editor: visual
---

\newpage

# Introduction
We suspect that Democrats will favor increasing spending in public schools more than social security. Whereas Republicans will be the other way around. So we will set up two hypothesis test using the Wilcoxon Signed Rank test.
Political division in the United States is on the rise (Abramowitz & Saunders, 2008; Jones, 2024). As polarization comes to a head in the current U.S. political climate artisanship has made its way into education, too, with state capitols becoming partisan battlegrounds over ideological issues compounded in intensity by their relation to children.
A partisan issue of our time is how American history should be taught, specifically as it pertains to narratives around race and the experience of Black Americans. With many Republican-led states passing legislation to ban Critical Race Theory in public schools, the nature of public education’s role in society comes into question (UCLA School of Law, 2023). What is the goal of public education? In a larger sense, do Democrats and Republicans have different views on education?
We may use voting behavior as a proxy for those who self-affiliate towards the right or left.

# Conceptualization and Operationalization
Question: Do Democratic and Republican voters have different views of education?
We interpret “voters” as survey respondents who indicated they identified more with either the Democratic party or the Republican party, whether this affiliation was strong or weak. [if space – justify why this flattening of the term “voters"] One way voters’ (i.e., survey respondents who identify themselves as Republican or Democrat) views and values are expressed are through attitudes on government spending. The ANES includes questions on federal spending for Social Security and public schools. We propose to use attitudes towards government spending on public schools to be our proxy towards views on education more broadly; specifically, we assume that voters who prioritize education are more likely to have indicated that “Federal spending on public schools should be increased.”
“Views of education” are far-reaching and nuanced, and cannot adequately be expressed through voting behavior alone; some voters may value education highly, but it may not be reflected at the ballot box because they are a single-issue voter (“32% of U.S. voters say they would only vote for a candidate for major office who shares their views on abortion,” says Gallup). Others may value education, but believe in private education rather than public schools. For operationalization, we use survey respondents’ reported attitudes towards federal spending on public schools, relative to other types of federal spending, as a proxy for views on education.
The subject of government spending is itself a barometer of political affiliation (Johnson, 2018). Therefore, our test will measure respondents’ relative preference toward spending; in this case, on education or on other government programs (Social Security).
We identify Republicans and Democrats via the feature V241227 (PARTY ID), which summarizes respondents’ party affiliation via a 1-7 scale: 1 indicates a “Strong Democrat,” 4 an “Independent,” and 7 a “Strong Republican.” Respondents who indicated they “Lean” towards one party, or consider themselves a “Not very strong” Democrat or Republican were grouped with their preferred party (Petrocik, 2009). Therefore, values of V241227 in [1,3] are coded as Democrats, and values in [5,7] are coded as Republicans. Values indicating the respondent refused to answer, did not know, was an Independent, or had no preference for political affiliation have been excluded. [how many were excluded?]

# Data Wrangling

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load packages, include=FALSE}
library(tidyverse) 
library(stats)
renv::snapshot()
```

```{r set options, include=FALSE}
theme_set(theme_bw())
knitr::opts_chunk$set(echo=FALSE, message=FALSE)
```

We begin by downloading the 2024 time series data from the ANES website and loading it into RStudio. Since we are comparing paired ratings of public school (V241264) and social security (V241261) responses, we filter out "Refused", "Don't know", and "Inapplicable" values in both categories. We limit both variables to values 1 = Increased, 2 = Decreased, and 3 = Kept the same. However, to prepare the data for a sign test, we need to recode each variable. We recode both the public school and social security variables so that 1 = Increased, 2 = Kept the same, and 3 = Decreases, so the responses are ordinal from highest to lowest funding support.

We want to perform the test separately for democrats and republicans, so we split the data by the party ID summary variable (V241227x). We categorize strong, not very strong, and independent-democrats as democrats (and likewise for republicans).Finally, we want to investigate the difference between sentiments towards public school and social security spending, so we calculate our difference variable as public school rating - social security rating for each pair of responses (V241264 - V241261).

```{r Data Wrangling, include = FALSE, echo = FALSE}
anes <- read_csv(("anes_timeseries_2024_csv_20250430.csv"))
anes = anes %>% 
  filter( V241264 %in% c(1,2,3) ) %>% 
  filter(V241261 %in% c(1,2,3)) #filter out unknown values
anes$public_schools <- c(1,3,2)[anes$V241264] #recode public schools
anes$social_security<- c(1,3,2)[anes$V241261] #recode social security so 1 = increase, 2= same, 3 = decrease
anes$Difference = anes$public_schools - anes$social_security

#Split into democrats and republicans according to party affiliation summary variable
democrats = anes %>% filter(V241227x %in% c(1,2,3))
republicans = anes %>% filter(V241227x %in% c(5,6, 7))
```

```{r, include = FALSE, echo = FALSE}
#Create histograms of difference by each party
hist(democrats$Difference, breaks = 20)
mean(democrats$Difference) #-0.17
median(democrats$Difference) #0
hist(republicans$Difference, breaks = 20)
mean(republicans$Difference) # 0.14
median(republicans$Difference)
```




# Data Understanding 

The data for this analysis is based on the American National Election Studies (ANES) 2024 Time Series Study, a continuation of the series of election studies conducted since 1948. The study used a mixed-mode design including in-person, internet, video, telephone, and paper-and-pencil interviewing.

The study's target population is the U.S. citizens who were 18 or older living in the US immediately prior to the 2016 presidential election.

Respondents were asked a series of questions that relates to the respondents opinion on electoral behavior, policy attitudes, and demographic characteristics.

# Test Set Up and Hypothesis:

Let Xi​ = preference for **public school spending (**V241264)**, where:**

-   1 = Increased

-   2 = Kept the same

-   3 = Decreased


Let Yi​ = preference for **social security spending (**V241261)**,** with the same code as Xi

Let Di = Xi - Yi, with interpretation:

-   (-) neagtive represents response to public schools is higher than response to social security: more support for schools

-   0 represents public schools and social security  coded the same: equal support (both Increase, both Same, or both Decrease)

-   (+) positive represents response to social security is higher than response to public school: more support for social security

**Test 1:**

\*\* Null hypothesis (Ho): P(Di \<0) \| i in Democrats = P(Di \>0) \| i in Democrats

Alternative hypothesis (H1): P(Di \<0) \| i in Democrats \> P(Di \>0) \| i in Democrats

**Test 2:\
** Null hypothesis (Ho): P(Di \<0) \| i in Republicans = P(Di \>0) \| i in Republicans

Alternative hypothesis (H1): P(Di \<0) \| i in Republicans \< P(Di \>0) \| i in Republicans

# Test Selection and Evaluation of Assumptions

We decided to use the Wilcoxon signed test (paired, one-sided) because this allows us to compare directional results from the same respondents. We favored the signed test instead of the signed-rank test as the responses are ordinal.

Assumption 1. (At least) Ordinal Scale - Xi and Yi are both measured on the same ordinal scale - We recoded the the responses to natural order (1 = Increased , 2 = Kept the same , 3 = Decreased)

Assumption 2. IID - ANES respondents were sampled independently - Each paired responses are from the same respondents


# Results

```{r, include = FALSE, echo = FALSE}
#Sign test for democrats
#Alternative hypothesis is public school response  < social security 
#Alternative hypothesis is  public school support > social security support 
# Count number of negative differences

# Total number of non-zero (non-tied) differences
binom.test(sum(democrats$Difference < 0, na.rm = TRUE), n = sum(democrats$Difference != 0, na.rm = TRUE), p = 0.5, alternative = "greater")


#Sign test for republicans
#Alternative hypothesis is public school response  > social security 
#ie public school support < social security support
binom.test(sum(republicans$Difference > 0, na.rm = TRUE), n = sum(republicans$Difference != 0, na.rm = TRUE), p = 0.5, alternative = "greater")

```

# Discussion
