---
title: "lab1markdown"
author: "Jimmy Wong, Gabrielle Doran, and Zev Rosen"
date-format: short
output:
  pdf_document: default
  html_document: default
editor: visual
format:
  pdf:
    documentclass: scrartcl
    classoption: onecolumn
---

---
title: "Lab 1"
author: "Jimmy, Gabrielle, and Zev" 
date: "`r Sys.Date()`"
date-format: short 
format: 
  pdf: 
    documentclass: scrartcl
    classoption: onecolumn
editor: visual
---


\newpage

# Introduction

We suspect that Democrats will favor increasing spending in public schools more than social security. Whereas Republicans will be the other way around. So we will set up two hypothesis test using the Wilcoxon Signed Rank test.

\
# Data Understanding
The data for this analysis is based on the American National Election Studies (ANES) 2024 Time Series Study, a continuation of the series of election studies conducted since 1948. The study used a mixed-mode design including in-person, internet, video, telephone, and paper-and-pencil interviewing.

The study's target population is the U.S. citizens who were 18 or older living in the US immediately prior to the 2016 presidential election. 

Respondents were asked a series of questions that relates to the respondents opinion on electoral behavior, policy attitudes, and demographic characteristics.

\
# Test Set Up and Hypothesis:

Let Xi​ = preference for **public school spending (**V241264)**, where:**

-   1 = Increased

-   2 = Kept the same

-   3 = Decreased

\

Let Yi​ = preference for **social security spending (**V241261)**,** with the same code as Xi

Let Di = Xi - Yi, with interpretation:

-   (-) neagtive represents response to public schools is higher than response to social security: more support for schools

-   0 represents public schools and social security  coded the same: equal support (both Increase, both Same, or both Decrease)

-   (+) positive represents response to social security is higher than response to public school: more support for social security

**Test 1:**

** Null hypothesis (Ho): P(Di <0) | i in Democrats = P(Di >0) | i in Democrats


Alternative hypothesis (H1): P(Di <0) | i in Democrats > P(Di >0) | i in Democrats

**Test 2:\
** Null hypothesis (Ho): P(Di <0) | i in Republicans = P(Di >0) | i in Republicans

Alternative hypothesis (H1): P(Di <0) | i in Republicans < P(Di >0) | i in Republicans

\
# Test Selection and Evaluation of Assumptions

We decided to use the Wilcoxon signed test (paired, one-sided) because this allows us to compare directional results from the same respondents. We favored the signed test instead of the signed-rank test as the responses are ordinal.

Assumption 1. (At least) Ordinal Scale
-   Xi and Yi are both measured on the same ordinal scale 
-   We recoded the the responses to natural order (1 = Increased , 2 = Kept the same , 3 = Decreased)

Assumption 2. IID
-   ANES respondents were sampled independently
-   Each paired responses are from the same respondents


\

# Data Wrangling 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load packages, include=FALSE}
library(tidyverse) 
library(stats)
renv::snapshot()
```

```{r set options, include=FALSE}
theme_set(theme_bw())
knitr::opts_chunk$set(echo=FALSE, message=FALSE)
```
We begin by downloading the 2024 time series data from the ANES website and loading it into RStudio. Since we are comparing paired ratings of public school (V241264) and social security (V241261) responses, we filter out "Refused", "Don't know", and "Inapplicable" values in both categories. We limit both variables to values 1 = Increased, 2 = Decreased, and 3 = Kept the same. However, to prepare the data for a sign test, we need to recode each variable. We recode both the public school and social security variables so that 1 = Increased, 2 = Kept the same, and 3 = Decreases, so the responses are ordinal from highest to lowest funding support. 

We want to perform the test separately for democrats and republicans, so we split the data by the party ID summary variable (V241227x). We categorize strong, not very strong, and independent-democrats as democrats (and likewise for republicans).Finally, we want to investigate the difference between sentiments towards public school and social security spending, so we calculate our difference variable as public school rating - social security rating for each pair of responses (V241264 - V241261).
```{r Data Wrangling, include = FALSE}
anes <- read_csv(("anes_timeseries_2024_csv_20250430.csv"))
anes = anes %>% 
  filter( V241264 %in% c(1,2,3) ) %>% 
  filter(V241261 %in% c(1,2,3)) #filter out unknown values
anes$public_schools <- c(1,3,2)[anes$V241264] #recode public schools
anes$social_security<- c(1,3,2)[anes$V241261] #recode social security so 1 = increase, 2= same, 3 = decrease
anes$Difference = anes$public_schools - anes$social_security

#Split into democrats and republicans according to party affiliation summary variable
democrats = anes %>% filter(V241227x %in% c(1,2,3))
republicans = anes %>% filter(V241227x %in% c(5,6, 7))
```


```{r}
#Create histograms of difference by each party
hist(democrats$Difference, breaks = 20)
mean(democrats$Difference) #-0.17
median(democrats$Difference) #0
hist(republicans$Difference, breaks = 20)
mean(republicans$Difference) # 0.14
median(republicans$Difference)
```

#Alternative hypothesis is public school \< social security

```{r}
#Sign test for democrats
#Alternative hypothesis is public school response  < social security 
#Alternative hypothesis is  public school support > social security support 
# Count number of negative differences

# Total number of non-zero (non-tied) differences
binom.test(sum(democrats$Difference < 0, na.rm = TRUE), n = sum(democrats$Difference != 0, na.rm = TRUE), p = 0.5, alternative = "greater")


#Sign test for republicans
#Alternative hypothesis is public school response  > social security 
#ie public school support < social security support
binom.test(sum(republicans$Difference > 0, na.rm = TRUE), n = sum(republicans$Difference != 0, na.rm = TRUE), p = 0.5, alternative = "greater")

```



# Results

# Discussion
